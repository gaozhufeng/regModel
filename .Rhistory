g<-geom_boxplot(colour="black")
g
g<-NULL
g<-ggplot(data=InsectSprays,aes(y=count,x=spray,fill=spray))
g<-geom_boxplot()
g
qplot(data=InsectSprays,aes(y=count,x=spray))
g<-NULL
g<-ggplot(data=InsectSprays,aes(y=count,x=spray,fill=spray))
g<-g+geom_boxplot()
g
library(tdlyr)
library(tdylr)
library(dplyr)
library(typlr)
library(tidyr)
spread(InsectSprays,spray)
str(InsectSprays)
spread(InsectSprays,key=spray,value=count)
?melt
View(InsectSprays)
filter(data=InsectSprays,spray="A")
filter(data=InsectSprays,spray=="A")
filter(data=InsectSprays,InsectSpraysspray=="A")
filter(data=InsectSprays,InsectSprays$spray=="A")
?filter
filter(InsectSprays,spray=="A")
summary(filter(InsectSprays,spray=="A"))
frequency(filter(InsectSprays,spray=="A"))
cbind(summary(filter(InsectSprays,spray=="A")),summary(filter(InsectSprays,spray=="B")),summary(filter(InsectSprays,spray=="C")))
cbind(summary(filter(InsectSprays,spray=="A")[,1]),summary(filter(InsectSprays,spray=="B")[,1]),summary(filter(InsectSprays,spray=="C")[,1]))
str(InsectSprays)
spray2<-relevel(InsectSprays$spray,"C")
str(spray2)
library(dplyr)
rswiss<-mutate(swiss,CatholicBin=1*(Catholic>50))
View(rswiss)
1>0
1*(1>0)
1*(1>2)
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBi\
n)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
g<-NULL
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBi\
n)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBi\n)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
g<-NULL
swiss = mutate(swiss, CatholicBin = 1 * (Catholic > 50))
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBi\n)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBi\n)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
g = ggplot(swiss, aes(x = Agriculture, y = Fertility, colour = factor(CatholicBin)))
g = g + geom_point(size = 6, colour = "black") + geom_point(size = 4)
g = g + xlab("% in Agriculture") + ylab("Fertility")
g
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
lm(y~x)
summary(lm(y~x))
fit<-lm(y~x)
resid(fit)
sd(resid(fit))
sd(resid(fit))/nrow(y)-2
sd(resid(fit))/(length(y)-2)
resid(fit)
sd(resid(fit))/(length(y))
sd(resid(fit))/(length(y)-2)
fit
resid(fit)
sd(resid(fit))
summary(fiut)
summary(fit)
summary(fit)
sd(resid(fit))/(length(y)-7)
mean(resid(fit))/(length(y)-7)
summary(fit)$sigma
summary(fit)
data(mtcars)
fit<-lm(data=mtcars,mpg~wt)
summary(fit)
fit<-lm(data=mtcars,mpg~I(wt-mean(wt))
)
fit
summary(fit)
summary(fit)$interval
predict(fit,mtcars,interval="confidence")
summary(fit)$confidence
summary(fit)
confint(fit)
?mtcars
head(mtcars)
predict(fit,newdata=(wt=3),interval="confidence")
fit
fit<-lm(y~x)
predict(fit,newdata=(wt=3),interval="confidence")
fit<-NULL
fit<-lm(data=mtcars,mpg~wt)
predict(fit,newdata=(wt=3),interval="confidence")
predict(fit,newdata=(wt=3),interval="prediction")
fit<-lm(y~x)
fit<-lm(data=mtcars,mpg~wt)
rm(Y)
rm(y)
rm(x)
predict(fit,newdata=(wt=.5),interval="confidence")
fit<-lm(data=mtcars,mpg~I(wt-mean(wt))
)
predict(fit,newdata=(wt=.5),interval="confidence")
summary(fit)
lm(data=mtcars,mpg~(wt*2000))
lm(data=mtcars,mpg~I(wt*2000))
lm(data=mtcars,mpg~I(wt/2000))
lm(data=mtcars,mpg~I(wt*2))
lm(data=mtcars,mpg~I(wt/2))
lm(data=mtcars,mpg~I(wt/2))
fit<-lm(data=mtcars,mpg~I(wt/2))
confint(fit)
summary(lm(data=mtcars,mpg~wt))
library(swirl)
swirl()
6
dim(InsectSprays)
head(InsectSprays)
head(InsectSprays,15)
A
sA
summary(InsectSprays[,2])
sapply(InsectSprays)
sapply(InsectSprays,class)
fit<-lm(count~spray)
fit<-lm(count~spray,InsectSprays)
coef(fit)
summary(fit)$coef
est<-summary(fit)$coef[,1]
mean(sA)
mean(sB)
nfit<-lm(count~spray-1)
nfit<-lm(count~spray-1,data=InsectSprays)
summary(nfit)$coef
spray2<-relevel(InsectSprays$spray,"C")
fit2<-lm(InsectSprays$count~spray2)
summary(fit2)$coef
mean(sC)
(fit$coef[2]-fit$coef[3])/1.6011
dim(hunger)
948
names(hunger)
fit<-lm(Numeric~year,hunger)
fit<-lm(Numeric~Year,hunger)
summary(fit)$coef
lmf<-lm(Numeric~Year,data=hunger[hunger$sex=="Female"])
lmf<-lm(Numeric~Year,data=hunger[hunger$sex=="Female",])
lmf<-lm(Numeric~Year,data=I(hunger[hunger$sex=="Female",]))
lmf<-lm(Numeric~Year,data=I(hunger[hunger$Sex=="Female",]))
lmF<-lm(Numeric~Year,data=I(hunger[hunger$Sex=="Female",]))
lmF <- lm(Numeric[Sex=="Female"] ~
| Year[Sex=="Female"],hunger)
lmF <- lm(Numeric[Sex=="Female"] ~ Year[Sex=="Female"],hunger)
lmM <- lm(Numeric[Sex=="Male"] ~ Year[Sex=="Male"],hunger)
lmBoth(Numeric~Year+Sex,data=hunger)
lmBoth<-lm(Numeric~Year+Sex,data=hunger)
summary(lmBoth)
lmInter<-lm(Numeric~Year+Sex+Sex*Year,data=hunger)
summary(lmInter)$coef
summary(lmInter)
?mtcars
swirl()
swirl()
n<-100;t<-rep(c(0,1),c(n/2,n/2));x<-c(runif(n/2),runif(n/2));
beta0<-0;beta1<-2;tau<-1;sigma<-.2
y<-beta0+x*beta1+t*tau+rnorm(n,sd=sigma)
rm(list=ls())
n<-100;t<-rep(c(0,1),c(n/2,n/2));x<-c(runif(n/2),runif(n/2));
beta0<-0;beta1<-2;tau<-1;sigma<-.2
y<-beta0+x*beta1+t*tau+rnorm(n,sd=sigma)
head(cbind(x,y))
plot(x,y,type="n")
plot(x,y,type="n",frame=FALSE)
abline(lm(y~x),lwd=2)
abline(h=mean(y[1:(n/2)]),lwd=3)
abline(h=mean(y[(n/2+1):n]),lwd=3)
fit<-lm(y~x+t)
abline(coef(fit)[1],coef(fit)[2],lwd=3)
abline(coef(fit)[1]+coef(fit)[3],coef(fit)[2],lwd=3)
points(x[1:(n/2)],y[1:(n/2)],pch=21,col="black",bg="lightblue",cex=2)
points(x[(n/2+1):n],y[(n/2+1):n],pch=21,col="black",bg="salmon",cex=2)
?plot
?which
which(LETTERS=="R")
g<-c(1:10)
which(g>5)
runif(10,-.1,.1)
plot(runif(1000,-.1,.1))
plot(rnorm(1000,-.1,.1))
?runif
plot(rnorm(1000,1,-1))
plot(rnorm(1000,-1,1))
data(InsectSprays)
fit<-lm(count~spray)
fit<-lm(count~spray,data=InsectSprays)
par(mfrow=c(2,2))
plot(fit)
rm(list=ls())
data(Seatbelts)
dt<-as.data.frame(Seatbelts)
names(Seatbelts)
names(dt)
library(dplur)
library(dplyr)
names(dt)
dt<-mutate(.data = dt,pp=(PetrolProce-mean(PetrolPrice)/sd(PetrolPrice)))
dt<-mutate(.data = dt,pp=(PetrolPrice-mean(PetrolPrice)/sd(PetrolPrice)))
head(Dt)
head(dt)
dt<-mutate(.data = dt,mm=kms-mean(kms))
dt<-mutate(.data = dt,mm=mm/1000)
head(dt)
fit<-lm(DriversKilled~mm+pp)
fit<-lm(DriversKilled~mm+pp,data=dt)
summary(fit)
mean(dt$pp)
mean(dt$mm)
mean(dt$pp)
fit<-lm(I(log(DriversKilled))~mm+pp,data=dt)
summary(fit)
summary(dt$pp)
pp<-dt$PetrolPrice
pNormalized<-(pp-mean(pp))/sd(pp)
summary(pNormalized)
install.packages("infotheo")
library(infotheo)
discretize(disc="equalwidth",x=pp,nbins=4)
discretize(disc="equalwidth",X=pp,nbins=4)
gg<-discretize(disc="equalwidth",x=pp,nbins=4)
gg<-discretize(disc="equalwidth",X=pp,nbins=4)
cbind(gg,pp)
table(gg)
summary(gg)
str(gg)
summary(as.factor(gg))
summary(as.factor(gg))
gt<-as.factor(gg)
gg
library(swirl)
swirl
swirl()
rpg1()
rgp1()
rgp2()
head(swiss)
mdl<-lm(data=swiss,Fertility~.)
vif(mdl)
1+1
mdl2 <- lm(Fertility ~ . -Examination, swiss)
vif(mdl2)
face
library(swirl)
swirl()
x1c<-simbias()
apply(x1c, 1, mean)
fit1<-lm(Fertility,Agriculture,data=swiss)
fit1<-lm(Fertility~Agriculture,data=swiss)
fit3<-lm(Fertility~Agriculture+Examination+Education,data=swiss)
anova(fit1,fit3)
deviance(fit3)
1+1
d <- deviance(fit3)/43
1+1
n <- (deviance(fit1) - deviance(fit3))/2
n/d
pdf(n/d,2,43,lower.tail=FALSE)
pf(n/d,2,43,lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1, fit3, fit5, fit6)
data(mtcars)
name(mtcars)
dt<-as.data.frame(mtcars)
names(dt)
fit<-lm(mpg~as.factor(cyl)*wt)
fit<-lm(mpg~as.factor(cyl)*wt,data=dt)
summary(fit)
fit<-lm(mpg~as.factor(cyl)+wt,data=dt)
summary(fit)
names(dt)
library(dplyr)
dt<-mutate(dt,cylFac=as.factor(cyl))
head(Dt)
head(dt)
str(dt)
fit1<-lm(mpg~cylFac*wt,data=dt)
summary(fit1)
summary(fit)
fit1<-lm(mpg~cylFac,data=dt)
rm(fit)
rm(fit1)
lm(data=dt,mpg~cylFac)
lm(data=dt,mpg~cylFac+wt)
fit<-lm(data=dt,mpg~cylFac+wt)
fit1<-lm(data=dt,mpg~cylFac)
summary(fit)
summary(fit1)
rm(fit)
rm(fit1)
fit<-lm(mpg~cylFac+wt)
fit<-lm(mpg~cylFac+wt,data=dt)
fit2<-lm(mpg~cylFac+wt,data=dt)
fit2<-lm(mpg~cylFac*wt,data=dt)
anova(fit,fit2)
fit3<-lm(mpg~cylFac+wt+cylFac*wt,data=dt)
anova(fit,fit3)
fit<-lm(mpg ~ I(wt * 0.5) + cylFac, data = dt)
data(mtcars)
fit<-lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
summary(fit)
fit<-lm(mpg ~ I(wt * 0.5) + factor(cyl)-1, data = mtcars)
summary(fit)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit<-lm(y~x)
hatvalues(fit)
plot(X,y)
plot(x,y)
abline(lm(y~x))
dffits(fit)
dfbetas(fit)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit<-lm(y~x)
hatvalues(fit)
dfbetas(fit)
mtcars
?mtcars
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
lm(mpg ~ I(wt * 0.5) + factor(cyl-1), data = mtcars)
lm(mpg ~ I(wt * 0.5) + factor(cyl)-1, data = mtcars)
lm(mpg ~ I(wt * 0.5) * factor(cyl)-1, data = mtcars)
summary(lm(mpg ~ I(wt * 0.5) * factor(cyl), data = mtcars))
summary(lm(mpg ~ I(wt * 0.5) * factor(cyl)-1, data = mtcars))
summary(lm(mpg ~ I(wt * 0.5) * factor(cyl), data = mtcars))
summary(lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars))
coef(lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars))
setwd("d:/rworking")
ls()
setwd("d:/gitrepos/regModel/")
list.files()
View("rCode.R")
library(datasets)
library(ggplot2)
library(dplyr)
library(tidyr)
dt<-mtcars
summary(dt)
cor(dt)
fit<-lm(data=dt,mpg~cyl*disp)
fit
summary(fit)
cor(dt)
?factor
?mtcars
head(mtcars)
plot(cor(mtcars))
str(mtcars)
dt<-mutate(mtcars,cyl=factor(cyl),am=factor(am))
str(am)
str(dt)
ggpairs(data=mtcars,lower=list(continuous="smooth"),params=c(method="loess"))
library(ggpairs)
install.packages("ggpairs")
?ggpairs
library(GGally)
ggpairs(data=mtcars,lower=list(continuous="smooth"),params=c(method="loess"))
fitAll<-lm(data=dt,mpg~.)
summary(fitAll)
plot(fit)
par(mfrow=c(2,2))
plot(fit)
fix(dt)
pairs(dt,
main = "Correlation between variables",
panel=panel.smooth)
g<-ggplot(data=mtcars,aes(y=mpg,x=as.factor(am),fill=as.factor(am)))
g<-g+geom_boxplot()
g<-g+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
g<-g+facet_grid(.~cyl) # having cyl as column
g<-g+xlab("Transmission type") ##labeling x axis
g<-g+ylab("Miles/(US) gallon") ## labeling y axis
g<-g+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legens.
g<-g+ggtitle("Comparison of Miles/galon for diffrenct cars\nbased on transmission type and number of cylinders")
g
g<-ggplot(data=mtcars,aes(y=mpg,x=as.factor(am),fill=as.factor(am)))
g<-g+geom_boxplot()
g<-g+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
g<-g+facet_grid(.~cyl) # having cyl as column
g<-g+xlab("Transmission type") ##labeling x axis
g<-g+ylab("Miles/(US) gallon") ## labeling y axis
g<-g+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legens.
g<-g+ggtitle("Comparison of Miles/galon for diffrenct cars\nbased on transmission type and number of cylinders")
g
g<-ggplot(data=mtcars,aes(y=mpg,x=as.factor(am),fill=as.factor(am)))
g<-g+geom_violin()
g<-g+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
g<-g+facet_grid(.~cyl) # having cyl as column
g<-g+xlab("Transmission type") ##labeling x axis
g<-g+ylab("Miles/(US) gallon") ## labeling y axis
g<-g+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legens.
g<-g+ggtitle("Comparison of Miles/galon for diffrenct cars\nbased on transmission type and number of cylinders")
g
hist(dt$mpg)
str(dt)
summary(ft)
summary(dt)
?case
?switch
c<-c(1,2,1,1,1,2)
c
switch(c,1,"Am",2,"Manual")
switch(c,1="Am",2="Manual")
switch(c,"Am"=1,"Manual"=2)
switch(1,"Am"=1,"Manual"=2)
switch(1,1="Am",2="Manual")
switch(c=1,"Am")
switch(c==1,"Am")
switch(c,"1"="Am","2"="Manual")
switch(1,"1"="Am","2"="Manual")
switch(2,"1"="Am","2"="Manual")
g<-c(1,2,1,1,1,2)
switch(g,"1"="Am","2"="Manual")
sapply(g,switch,c("1"="Am","2"="Manual"))
apply(g,switch,c("1"="Am","2"="Manual"))
sapply(g,switch("1"="Am","2"="Manual"))
apply(g,switch("1"="Am","2"="Manual"))
tapply(g,switch("1"="Am","2"="Manual"))
mapply(g,switch("1"="Am","2"="Manual"))
?ggpairs
?ggpairs
cor(dt)
cor(mrcars)
cor(mtcars)
cor(dt)
cor(select(dt,-cyl,am))
select(dt)
select(dt,-c(cyl,am))
cor(select(dt,-c(cyl,am)))
lm(data=dt,mpg~am)
lm(data=dt,mpg~am-1)
lm(data=dt,mpg~am)
names(dt)
?Dt
?dt
?mtcar
?mtcars
str(mtr)
str(Dt)
str(dt)
dt<-mutate(mtcars,cyl=factor(cyl),am=factor(am),vs=factor(vs))
ggpairs(data=mtcars,lower=list(continuous="smooth"),params=c(method="loess"))
ggpairs(data=dt,lower=list(continuous="smooth"),params=c(method="loess"))
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp+wt)
fit3<-lm(data=dt,mpg~am+disp+wt+cyl)
fit4<-lm(data=dt,mpg~am+disp+wt+cyl+carb)
fit5<-lm(data=dt,mpg~am+disp+wt+cyl+carb+gear)
fit6<-lm(data=dt,mpg~am+disp+wt+cyl+carb+gear+vs)
anova(fit1,fit2,fit3,fit4,fit,5,fit6)
anova(fit1,fit2,fit3,fit4,fit5,fit6)
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp+wt)
fit3<-lm(data=dt,mpg~am+disp+wt+cyl)
fit4<-lm(data=dt,mpg~am+disp+wt+cyl+carb)
fit5<-lm(data=dt,mpg~am+disp+wt+cyl+carb+vs)
fit6<-lm(data=dt,mpg~am+disp+wt+cyl+carb+gear+vs)
anova(fit1,fit2,fit3,fit4,fit5,fit6)
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp)
fit3<-lm(data=dt,mpg~am+disp+wt)
fit4<-lm(data=dt,mpg~am+disp+wt+cyl)
fit5<-lm(data=dt,mpg~am+disp+wt+cyl+carb)
fit6<-lm(data=dt,mpg~am+disp+wt+cyl+carb+vs)
fit7<-lm(data=dt,mpg~am+disp+wt+cyl+carb+gear+vs)
anova(fit1,fit2,fit3,fit4,fit5,fit6,fit7)
dffit(fit4)
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp)
fit3<-lm(data=dt,mpg~am+disp+cyl)
fit4<-lm(data=dt,mpg~am+disp+wt+cyl)
fit5<-lm(data=dt,mpg~am+disp+wt+cyl+carb)
fit6<-lm(data=dt,mpg~am+disp+wt+cyl+carb+vs)
fit7<-lm(data=dt,mpg~am+disp+wt+cyl+carb+gear+vs)
anova(fit1,fit2,fit3,fit4,fit5,fit6,fit7)
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp)
fit3<-lm(data=dt,mpg~am+disp+cyl)
fit4<-lm(data=dt,mpg~am+disp+cyl+carb)
fit5<-lm(data=dt,mpg~am+disp+cyl+carb+wt)
fit6<-lm(data=dt,mpg~am+disp+wt+cyl+carb+vs)
fit7<-lm(data=dt,mpg~am+disp+wt+cyl+carb+gear+vs)
anova(fit1,fit2,fit3,fit4,fit5,fit6,fit7)
cor(mtcars)
