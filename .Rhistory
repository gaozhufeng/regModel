shapiro.test(fit2$residuals)
shapiro.test(fit3$residuals)
shapiro.test(fit4$residuals)
shapiro.test(fit5$residuals)
shapiro.test(fit6$residuals)
shapiro.test(fit7$residuals)
?shapiro.test
shapiro.test(fit7$residuals)
names(k)
gg<-c(fit1,fi2)
gg<-c(fit1,fit2)
str(gg)
sapply(gg,shapiro.test)
?sapply
gg
lapply(gg,shapiro.test)
gg<-c(fit1$residuals,fit2$residuals)
gg
gg<-c(fit1,fit2)
shapiro.test(gg)
shapiro.test(gg$residuals)
gg$residuals
gg
shapiro.test(fit1$residuals)
shapiro.test(fit1$residuals,fit2$residuals)
shapiro.test(c(fit1$residuals,fit2$residuals))
shapiro.test(list(fit1$residuals,fit2$residuals))
list(fit1,fit2)
l<-list(fit1,fit2)
shapiro.test(l)
shapiro.test(fit1$residuals)
shapiro.test(fit1$residuals)["p-value"]
shapiro.test(fit1$residuals)[["p-value"]]
shapiro.test(fit1$residuals)[p-value]
shapiro.test(fit1$residuals)[2]
names(dt)
str(dt)
dtNum<-select(dt,c(-cyl,-am-vs))
head(dtNum)
cor(dtNum)
dtNum<-select(dt,-c(cyl,am,vs))
dtNum
head(dtNum)
cor(dtNum)
dtNum<-select(dt,-c(mpg,cyl,am,vs))
cor(dtNum)
summary(fit7)
(summary(fit7))$adj.r.squared
(summary(fit6))$adj.r.squared
(summary(fit1))$adj.r.squared
(summary(fit2))$adj.r.squared
(summary(fit3))$adj.r.squared
(summary(fit4))$adj.r.squared
(summary(fit5))$adj.r.squared
(summary(fit6))$adj.r.squared
(summary(fit7))$adj.r.squared
anova(fit1,fit2,fit3,fit4,fit5,fit6,fit7)
(summary(fit4))$adj.r.squared
l<-list(fit1,fit2)
lapply(l,summary)
rbind(summary(fit4)$adj.r.squared,summary(fit3)$adj.r.squared)
summary(fit4)$adj.r.squared
summary(fit4)
names(summary(fit4))
summary(fit4)[8:9]
summary(fit4)[8:9,]
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp)
fit3<-lm(data=dt,mpg~am+disp+cyl)
fit4<-lm(data=dt,mpg~am+disp+cyl+carb)
fit5<-lm(data=dt,mpg~am+disp+cyl+carb+wt)
fit6<-lm(data=dt,mpg~am+disp+cyl+carb+wt+vs)
fit7<-lm(data=dt,mpg~am+disp+cyl+carb+wt+vs+gear)
anova(fit1,fit2,fit3,fit4,fit5,fit6,fit7)
anova(fit4,fit7)
anova(fit4,fit6)
anova(fit4,fit5)
anova(fit4,fit3)
anova(fit3,fit4)
anova(fit1,fit4)
anova(fit1,fit7)
anova(fit3,fit7)
fit8<-lm(data=dt,mpg~am+disp+hp)
anova(fit4,fit8)
anova(fit8,fit4)
corr(dtNum)
cor(dtNum)
corr(mtcars)
cor(mtcars)
t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
anova(t1,t2,t3,fit4)
t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
anova(t1,fit4)
install.packages("leaps")
library(leaps)
?leaps
x<-matrix(rnorm(100),ncol=4)
y<-rnorm(25)
leaps(x,y)
x
data(swiss)
a<-regsubsets(as.matrix(swiss[,-1]),swiss[,1])
summary(a)
b<-regsubsets(Fertility~.,data=swiss,nbest=2)
summary(b)
coef(a, 1:3)
vcov(a, 3)
null=lm(data=dt,mpg~am)
full=lm(data=dt,mpg~.)
step(null,scope=list(lower=null,upper=full,direction="forward"))
t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
t4<-lm(data=dt,mpg~am+hp+wt+cyl)
anova(t1,t2,t3,fit4)
t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
t4<-lm(data=dt,mpg~am+hp+wt+cyl)
anova(t1,t2,t3,t4,fit4)
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp)
fit3<-lm(data=dt,mpg~am+disp+cyl)
fit4<-lm(data=dt,mpg~am+disp+cyl+carb)
fit5<-lm(data=dt,mpg~am+disp+cyl+carb+wt)
fit6<-lm(data=dt,mpg~am+disp+cyl+carb+wt+vs)
fit7<-lm(data=dt,mpg~am+disp+cyl+carb+wt+vs+gear)
anova(fit1,fit2,fit3,fit4,fit5,fit6,fit7)
t4<-lm(data=dt,mpg~am+hp+wt+gear)
anova(t1,t2,t3,t4)
t<-anova(t1,t2,t3,t4)
names(t)
summary(t4)$adj.r.squared
summary(t3)$adj.r.squared
summary(t2)$adj.r.squared
step(null,scope=list(lower=null,upper=full,direction="forward"))
t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
t4<-lm(data=dt,mpg~am+hp+wt+cyl)
anova(t1,t2,t3,t4)
q<-step(null,scope=list(lower=null,upper=full,direction="forward"))
shapiro.test(t4)
shapiro.test(t4$residuals)
shapiro.test(t3$residuals)
fit1<-lm(data=dt,mpg~am)
fit2<-lm(data=dt,mpg~am+disp)
fit4<-lm(data=dt,mpg~am+disp+carb)
fit5<-lm(data=dt,mpg~am+disp+carb+wt)
fit6<-lm(data=dt,mpg~am+disp+carb+wt+vs)
fit7<-lm(data=dt,mpg~am+disp+carb+wt+vs+gear)
anova(fit1,fit2,fit4,fit5,fit6,fit7)
anova(fit4,t3)
anova(t3,fit4)
summary(fit4)$adj.r.squared
summary(t3)$adj.r.squared
summary(t4)$adj.r.squared
anova(t3,t4,fit4t)
anova(t3,t4,fit4)
anova(fit4,t3,t4)
cor(mtcars)
q
null=lm(data=dt,mpg~am)
full=lm(data=dt,mpg~.)
q<-step(null,scope=list(lower=null,upper=full,direction="forward"))
t4<-lm(data=dt,mpg~am+hp+wt+gear)
anova(t1,t2,t3,t4)
t4<-lm(data=dt,mpg~am+hp+wt+gear)t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
t4<-lm(data=dt,mpg~am+hp+wt+gear)
t5<-lm(data=dt,mpg~am+hp+wt+drat)
anova(t1,t2,t3,t4,t5)
t4<-lm(data=dt,mpg~am+hp+wt+gear)t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
t4<-lm(data=dt,mpg~am+hp+wt+gear)
t5<-lm(data=dt,mpg~am+hp+wt+drat)
anova(t3,t5)
anova(t1,t2,t3,t4,t5)
?anova
predictors<-colnames(mtcars)[c(2,3,4,5,6,7,8,10,11)]
predictors
?as.formula
library(datasets);library(ggplot2);library(dplyr);library(tidyr);library(GGally); library(car)
?ggpairs
names(mtcars)
dm<-mtcars[c(1,3,4,6),]
dm
dm<-mtcars[,c(1,3,4,6)]
dm
ggpairs(dm)
ggpairs(dm,params=c(method="lm"))
ggpairs(dm,params=c(method="lm",color=am))
names(mtcars)
dm<-mtcars[,c(1,3,4,6,9)]
dm
ggpairs(dm,params=c(method="lm",color=am))
ggpairs(dm,params=c(method="lm",color=dm$am))
ggpairs(dm, upper = list(continuous = "density", combo = "box"),
lower = list(continuous = "points", combo = "dot")
)
custom_car <- ggpairs(mtcars[,c("mpg","wt","cyl")], upper = "blank", title = "Custom Example")
# ggplot example taken from example(geom_text)
plot <- ggplot(mtcars, aes(x=wt, y=mpg, label=rownames(mtcars)))
plot <- plot + geom_text(aes(colour=factor(cyl)), size = 3) + scale_colour_discrete(l=40)
custom_car <- putPlot(custom_car, plot, 1, 2)
personal_plot <- ggally_text(
"ggpairs allows you\nto put in your\nown plot.\nLike that one.\n <---"
)
custom_car <- putPlot(custom_car, personal_plot, 1, 3)
personal_plot
custom_car
ggpairs(dm\)
ggpairs(dm)
?pairs
ggpairs(dm,params=c(smooth="lm")
)
ggpairs(dm,lower=list(continuous = "smooth"),color="color" )
ggpairs(dm,lower=list(continuous = "smooth"),color=cyl )
ggpairs(dm,lower=list(continuous = "smooth"),color=dm$cyl )
ggpairs(dm,lower=list(continuous = "smooth"),color="red" )
ggpairs(dm,lower=list(continuous = "smooth"),shape="cut" )
ggpairs(dm,lower=list(continuous = "smooth"),  diag=list(continuous="density",discrete="bar"), )
ggpairs(dm,lower=list(continuous = "smooth"),  params = c(method = "loess"),
axisLabels = "show") )
ggpairs(dm,lower=list(continuous = "smooth"),  params = c(method = "loess"),axisLabels = "show")
ggpairs(dm,lower=list(continuous = "smooth")
)
ggpairs(dm,lower=list(continuous = "smooth",color="red"))
ggpairs(dm,lower=list(continuous = "smooth"),color="color")
ggpairs(dm,lower=list(continuous = "smooth"),color="mpg")
ggpairs(dm,lower=list(continuous = "smooth"),color="cyl")
ggpairs(dm,lower=list(continuous = "smooth"))
ggpairs(mtcars,lower=list(continuous = "smooth"))
?ggpairs
library(datasets);library(ggplot2);library(dplyr);library(tidyr);library(GGally); library(car)
dt<-mutate(mtcars,am=factor(am),vs=factor(vs)) ##adjusting column type
row.names(dt)<-row.names(mtcars)
mpgMean<-mean(dt$mpg);mpgSd<-sd(dt$mpg)
summary(dt) ##lets see the data
?ggpairs
?pairs
hist(dt$mpg,col="gray",xlab = "Miles/(US) gallon",ylab = "Count",main="Fig.1: Histogram of miles per gallon")##figure1
abline(v = mean(dt$mpg),col="red")
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am),legend=NULL)
fig2<-fig2+geom_violin()
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
fig2<-fig2+xlab("Transmission type")+ylab("Miles/(US) gallon") ## labeling y axis ##labeling x,y axis
##fig2<-fig2+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legends.
fig2<-fig2+ggtitle("Fig.2:Comparison of Miles/galon for diffrenct cars\nbased on transmission type")+guides(fill=FALSE)
fig2
setwd("d:/gitrepos/regModel")
source(multiPlot.R)
ls()
files.list()
list.files()
source("models")
source("multiPlot.R")
g<-ggplot(data=mtcars,aes(y=mpg,x=as.factor(am),fill=as.factor(am)))
g<-g+geom_violin()
##g<-g+facet_grid(.~cyl) # having cyl as column
g<-g+xlab("Transmission type") ##labeling x axis
g<-g+ylab("Miles/(US) gallon") ## labeling y axis
g<-g+ggtitle("Comparison of Miles/galon for diffrenct cars\nbased on transmission type and number of cylinders")
g<-g+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
g<-g+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legens.
g
g<-ggplot(data=mtcars,aes(y=mpg,x=as.factor(am),fill=as.factor(am)))
g<-g+geom_violin()
g<-g+facet_grid(.~cyl) # having cyl as column
g<-g+xlab("Transmission type") ##labeling x axis
g<-g+ylab("Miles/(US) gallon") ## labeling y axis
g<-g+ggtitle("Comparison of Miles/galon for diffrenct cars\nbased on transmission type and number of cylinders")
g<-g+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
g<-g+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legens.
g
t4
t1<-lm(data=dt,mpg~am)
t2<-lm(data=dt,mpg~am+hp)
t3<-lm(data=dt,mpg~am+hp+wt)
t4<-lm(data=dt,mpg~am+hp+wt+qsec)
t5<-lm(data=dt,mpg~am+hp+wt+cyl)
t6<-lm(data=dt,mpg~am+hp+wt+drat)
t4
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,fil=am))
fig3<-fig3+geom_line()
fig3
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,fil=am),colors=am)
fig3<-fig3+geom_line()
fig3
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,colors=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1)
fig3
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1)
fig3
fig3+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul"))
fig3+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul"))
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1)
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1)
fig4
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1)
fig4
fig5
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")
fig5
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=("red","green")))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=c("red","green")))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")
fig5
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")
fig5
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Comparison of mileages per gallon for transmission types")
fig2
fig2+scale_fill_discrete(name="Transmission type",breaks=c(0,1),labels=c("Automaitc","Manaul")) ## setting correct names for legens.
fig2+g<-g+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))
fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Comparison of mileages per gallon for transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig2
?mtcars
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Fig.2:Comparison of mileages per gallon and transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Horspower")+ylab("Miles/(US) gallon")+ggtitle("Fig.3:Comparison of mileages per gallon and horsepower\n for each transmission types")
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Weigth (kib)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and weigth\n for each transmission types")
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")
multiplot(fig2,fig3,fig4,fig5)
multiplot(fig2,fig3,fig4,fig5,col=2)
multiplot(fig2,fig3,fig4,fig5,cols=2)
fig5+scale_fill_discrete(name="Transmission type",breaks=am,labels=c("Automaitc","Manaul"))
fig5+scale_fill_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,fill=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")
fig5+scale_fill_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,fill=am,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")
fig5+scale_fill_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")
fig5+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")
fig5+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5+fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Fig.2:Comparison of mileages per gallon and transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Horspower")+ylab("Miles/(US) gallon")+ggtitle("Fig.3:Comparison of mileages per gallon and horsepower\n for each transmission types")+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Weigth (kib)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and weigth\n for each transmission types")+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
multiplot(fig2,fig4,fig3,fig5,cols=2)
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Fig.2:Comparison of mileages per gallon and transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Horspower")+ylab("Miles/(US) gallon")+ggtitle("Fig.3:Comparison of mileages per gallon and horsepower\n for each transmission types")+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Weigth (kib)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and weigth\n for each transmission types")+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")+scale_color_discrete(name="Transmission type",breaks=dt$am,labels=c("Automaitc","Manaul"))
multiplot(fig2,fig4,fig3,fig5,cols=2)
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Fig.2:Comparison of mileages per gallon and transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Horspower")+ylab("Miles/(US) gallon")+ggtitle("Fig.3:Comparison of mileages per gallon and horsepower\n for each transmission types")+scale_color_discrete(name="Trans.",breaks=dt$am,labels=c("Auto.","Manaul"))
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Weigth (kib)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and weigth\n for each transmission types")+scale_color_discrete(name="Trans.",breaks=dt$am,labels=c("Auto.","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")+scale_color_discrete(name="Trans.",breaks=dt$am,labels=c("Auto.","Manaul"))
multiplot(fig2,fig4,fig3,fig5,cols=2)
fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Fig.2:Comparison of mileages per gallon and transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Horspower")+ylab("Miles/(US) gallon")+ggtitle("Fig.3:Comparison of mileages per gallon and horsepower\n for each transmission types")+scale_color_discrete(name="Trans.",breaks=dt$am,labels=c("Auto.","Manaul"))
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Weigth (kib)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and weigth\n for each transmission types")+scale_color_discrete(name="Trans.",breaks=dt$am,labels=c("Auto.","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")+scale_color_discrete(name="Trans.",breaks=dt$am,labels=c("Auto.","Manaul"))fig2<-ggplot(data=dt,aes(y=mpg,x=am,fill=am))+geom_violin()+xlab("Transmission type")+ylab("Miles/(US) gallon")+ggtitle("Fig.2:Comparison of mileages per gallon and transmission types")
fig2<-fig2+scale_x_discrete(breaks=c(0,1),labels=c("Automaitc","Manaul"))+guides(fill=FALSE)
fig3<-ggplot(data=dt,aes(y=mpg,x=hp,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Horspower")+ylab("Miles/(US) gallon")+ggtitle("Fig.3:Comparison of mileages per gallon and horsepower\n for each transmission types")+scale_color_discrete(name="Trans.",breaks=c(0,1),labels=c("Auto.","Manaul"))
fig4<-ggplot(data=dt,aes(y=mpg,x=wt,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("Weigth (kib)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and weigth\n for each transmission types")+scale_color_discrete(name="Trans.",breaks=c(0,1),labels=c("Auto.","Manaul"))
fig5<-ggplot(data=dt,aes(y=mpg,x=qsec,color=am))+geom_point(alpha=.3)+geom_smooth(alpha=.2,size=1,method="lm")+xlab("1/4 mile time (seconds)")+ylab("Miles/(US) gallon")+ggtitle("Fig.4:Comparison of mileages per gallon and 1/4 mile time \n for each transmission types")+scale_color_discrete(name="Trans.",breaks=c(0,1),labels=c("Auto.","Manaul"))
multiplot(fig2,fig4,fig3,fig5,cols=2)
multiplot(fig2,fig4,fig3,fig5,cols=2)
result <- t.test(mpg ~ am);result$p.value;result$estimate
result <- t.test(data,=dtmpg ~ am);result$p.value;result$estimate
result <- t.test(data,=dt,mpg ~ am);result$p.value;result$estimate
result <- t.test(dt$mpg ~ dt$am);result$p.value;result$estimate
17-24
leveneTest(mpg ~ factor(am), data = mtcars_vars)
library(car)
leveneTest(mpg ~ factor(am), data = mtcars_vars)
leveneTest(mpg ~ factor(am), data = dt)
?leveneTest
fit<-lm(data=dt,mpg~am)
summary(fit)$adj.r.squared
t.test(dt$mpg ~ d$am)
t.test(dt$mpg ~ dt$am)
plot(t4)
par(mfrow=c(2,2))
plot(t4)
par(mfrow=c(2,2))
plot(t4,main="blah blah")
par(mfrow=c(2,2))
plot(t4,title="blah blah")
mtext("My 'Title' in a strange place")
mtext("My 'Title' in a strange place", side = 3, line = -21, outer = TRUE)
mtext("My 'Title' in a strange place"outer = TRUE)
mtext("My 'Title' in a strange place",outer = TRUE)
par(mfrow=c(2,2))
plot(t4)
par(mfrow=c(2,2))
plot(t4)
mtext("My 'Title' in a strange place",outer = TRUE)
title("My 'Title' in a strange place")
title("My 'Title' in a strange place",outer=TRUE)
par(mfrow=c(2,2))
title("My 'Title' in a strange place",outer=TRUE)
plot(t4)
par(mfrow=c(2,2))
plot(t4)
title("My 'Title' in a strange place",outer=TRUE)
par(mfrow=c(2,2))
plot(t4)
title("My 'Title' in a strange place",lines=-10,outer=TRUE)
par(mfrow=c(2,2))
plot(t4)
mtext("My 'Title' in a strange place",outer=TRUE,lines=-10)
set.seed(42)
oldpar <- par(mfrow=c(1,2), mar=c(3,3,1,1), oma=c(0,0,3,1))  ## oma creates space
plot(cumsum(rnorm(100)), type='l', main="Plot A")
plot(cumsum(rnorm(100)), type='l', main="Plot B")
mtext("Now isn't this random", side=3, line=1, outer=TRUE, cex=2, font=2)
par(oldpar)
par(mfrow=c(2,2))
plot(t4)
mtext("My 'Title' in a strange place",outer=TRUE,side=3, line=1)
mtext("My 'Title' in a strange place",outer=TRUE,side=3, line=-1)
mtext("My 'Title' in a strange place",outer=TRUE,side=3, line=-3)
mtext("My 'Title' in a strange place",outer=TRUE,side=3, line=-2)
par(mfrow=c(2,2))
plot(t4)
mtext("My 'Title' in a strange place",outer=TRUE,side=3, line=-2)
Mod1<-lm(data=dt,mpg~am)
Mod2<-lm(data=dt,mpg~am+hp)
Mod3<-lm(data=dt,mpg~am+hp+wt)
Mod4<-lm(data=dt,mpg~am+hp+wt+qsec)
Mod5<-lm(data=dt,mpg~am+hp+wt+cyl)
Mod6<-lm(data=dt,mpg~am+hp+wt+drat)
anova(Mod1,Mod2,Mod3,Mod4,Mod5,Mod6)
for(i in 1:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared;
mods<cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
anova(Mod1,Mod2,Mod3,Mod4,Mod5,Mod6)
for(i in 1:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared;
mods<-cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
for(i in 1:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared;mods<-null
mods<cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
for(i in 1:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared;mods<-NULL;
mods<cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
mods
mods<-round(summary(Mod1)$adj.r.squared),4)
for(i in 2:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared
mods<cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
mods<-round(summary(Mod1)$adj.r.squared),4)
mods<-summary(Mod1)$adj.r.squared
mods<-round(summary(Mod1)$adj.r.squared,4)
mods<-round(summary(Mod1)$adj.r.squared,4)
for(i in 2:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared
mods<cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
mods
mods<-round(summary(Mod1)$adj.r.squared,4)
for(i in 2:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared
mods<-cbind(mods,paste("Model ",model,"'s Adj.r.squared: ",round(st,4),sep=""))}
mods
mods<-round(summary(Mod1)$adj.r.squared,4)
for(i in 2:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared
mods<-cbind(mods,paste(model,"=",round(st,4),sep=""))}
mods
mods<-paste("Mod1=",round(summary(Mod1)$adj.r.squared,4))
for(i in 2:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared
mods<-cbind(mods,paste(model,"=",round(st,4),sep=""))}
mods
models_adjusted_r_squared<-paste("Mod1=",round(summary(Mod1)$adj.r.squared,4))
for(i in 2:6){
model<-paste("Mod",i,sep = "");
st<-summary(eval(parse(text=model)))$adj.r.squared
models_adjusted_r_squared<-cbind(models_adjusted_r_squared,paste(model,"=",round(st,4),sep=""))}
models_adjusted_r_squared
anova(Mod1,Mod2,Mod3,Mod4,Mod5,Mod6)
models_adjusted_r_squared[1]
models_adjusted_r_squared[1:6]
paste(print("Mmodels adjusted r squared:\n"),models_adjusted_r_squared[1:6],sep = "")
c(print("Mmodels adjusted r squared:\n"),models_adjusted_r_squared[1:6])
c("Mmodels adjusted r squared:\n",models_adjusted_r_squared[1:6])
c("Mmodels adjusted r squared:",models_adjusted_r_squared[1:6])
summary(Mod4)
?mtcars
summaru(lm(mpg~am+cyl+wt+hp))
summary(lm(mpg~am+cyl+wt+hp))
summary(lm(mpg~am+cyl+wt+hp,data=dt))
summary(Mod4)
summary(lm(mpg~am+cyl+wt,data=dt))
summary(lm(mpg~am+wt,data=dt))
coef(Mod4)
summary(Mod4)
summary(Mod4)$coef
summary(Mod4)
